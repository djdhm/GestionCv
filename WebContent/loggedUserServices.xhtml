<?xml version="1.0" encoding="UTF-8" ?>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">
<script type="text/javascript">
        function editLastDatatableRow(){

      jQuery('.ui-datatable-data tr').last().find('span.ui-icon-pencil').each(function(){
         jQuery(this).click()
      });
   }

    </script>
<ui:composition template="/template/mylayout.xhtml">
	<ui:define name="content">
		<f:view>

			<c:set var="p" value="#{userSpaceView.personne}" />
			<h1>Informations personnelles :</h1>
			<h:outputText value="Nom : " />
			<h:outputText value="#{p.nom}" />
			<br />

			<h:outputText value="Prenom : " />
			<h:outputText value="#{p.prenom}" />
			<br />

			<h:outputText value="Mail : " />
			<h:outputText value="#{p.email}" />
			<br />

			<h:outputText value="Site Web : " />
			<h:outputText value="#{p.siteweb}" />
			<br />

			<h:outputText value="Date de naissance : " />
			<h:outputText value="#{p.dateNaissance}">
				<f:convertDateTime pattern="dd-MM-yyyy" />
				<!-- Format de conversion date identique peu importe si input ou output-->
			</h:outputText>
			<br />

			<h:outputText value="Mot de passe : " />
			<h:outputText value="#{p.password}" />
			<br />

			<h:form id="logout">
				<div class="form-group">
					<h:commandButton action="#{userSpaceView.logout()}"
						styleClass="btn btn-primary" value="Logout" />
					<span> </span>
				</div>
			</h:form>
			<h:form id="form">
				<p:growl id="msgs" showDetail="true" />
				<p:dataTable id="listeAct" widgetVar="activities" var="activity"
					value="#{userSpaceView.activities}" editable="true"
					emptyMessage="Aucune Activite	 "
					style="margin-bottom:00px;width:100%">
					<f:facet name="header">
			            Mes activites
			        </f:facet>
					<p:ajax event="rowEdit" listener="#{userSpaceView.onRowEdit}"
						update=":form:msgs" />
					<p:ajax event="rowEditCancel"
						listener="#{userSpaceView.onRowCancel}" update=":form:msgs" />

					<p:column headerText="Titre	">
						<p:cellEditor>
							<f:facet name="output">
								<h:outputText value="#{activity.titre}" />
							</f:facet>
							<f:facet name="input">
								<p:inputText id="titre" value="#{activity.titre}"
									style="width:100%" />
							</f:facet>
						</p:cellEditor>
					</p:column>
					<p:column headerText="Nature" sortBy="#{activity.nature}">
						<p:cellEditor>
							<f:facet name="output">
								<h:outputText value="#{activity.nature}" />
							</f:facet>
							<f:facet name="input">
								<h:selectOneMenu
									styleClass="ui-inputfield ui-inputtext ui-widget ui-state-default ui-corner-all"
									value="#{activity.nature}" style="width:100%;height:100%;">
									<f:selectItems value="#{userSpaceView.natures}" var="nature"
										itemLabel="#{nature}" itemValue="#{nature}"
										style="width:100%;height:100%;" />
								</h:selectOneMenu>
							</f:facet>
						</p:cellEditor>
					</p:column>
					<p:column headerText="Annee" sortBy="#{activity.annee}">
						<p:cellEditor>
							<f:facet name="output">
								<h:outputText value="#{activity.annee}">  </h:outputText>
							</f:facet>
							<f:facet name="input">
								<p:inputText value="#{activity.annee}" style="width:100%"
									label="annee" />
							</f:facet>
						</p:cellEditor>
					</p:column>
					<p:column headerText="Description">
						<p:cellEditor>
							<f:facet name="output">
								<h:outputText value="#{activity.description}" />
							</f:facet>
							<f:facet name="input">
								<p:inputText value="#{activity.description}" style="width:100%"
									label="annee" />
							</f:facet>
						</p:cellEditor>
					</p:column>
					<p:column headerText="Site Web ">
						<p:cellEditor>

							<f:facet name="output">
								<h:outputText value="#{activity.siteWeb}" />
							</f:facet>
							<f:facet name="input">
								<p:inputText value="#{activity.siteWeb}" style="width:100%"
									label="annee" />
							</f:facet>
							
						
						</p:cellEditor>
					</p:column>

					<p:column style="width:35px">
						<p:rowEditor />
					</p:column>

					<p:column style="width:50px">
					<p:commandButton icon="ui-icon-trash" style="width:30px;"
                        title="Supprimer"
                        actionListener="#{userSpaceView.supprimerActivite(activity)}"
                        update="form"
                        > 
                                                        <p:confirm header="Attention!" message="Voulez vous vraiment supprimer cette activite?" icon="pi pi-exclamation-triangle" />
                        
                        </p:commandButton>			
                        	<p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
	    			   		<p:commandButton value="Oui" type="button" styleClass="ui-confirmdialog-yes" icon="pi pi-check" />
	     				   	<p:commandButton value="Non" type="button" styleClass="ui-confirmdialog-no" icon="pi pi-times" />
			 	   </p:confirmDialog>  
                        </p:column>


				</p:dataTable>

			


	
				

			</h:form>

			

			<h:form id="inscription">

				<c:set var="p" value="#{userSpaceView.signingUpPerson}" />
				<p:panel header="Nouvelle Activite" style="width: 800px;">

					<h:panelGrid columns="3">
					<p:outputLabel value="Titre:*" />
						<p:inputText id="titre"
							value="#{userSpaceView.nouvelleActivite.titre}" required="true"
							label="Titre" style="width:100%"
							placeholder="titre de l'activite">
							<p:ajax event="keyup" update="titreMsg"></p:ajax>
						</p:inputText>
						<p:message id="titreMsg" for="titre" />
						
						
						

						<p:outputLabel value="Categorie:*" />
						<h:selectOneMenu required="true" label="Categorie*:" id="cat"
							styleClass="ui-inputfield ui-inputtext ui-widget ui-state-default ui-corner-all"
							value="#{userSpaceView.nouvelleActivite.nature}"
							style="width:100%;height:100%;">
							<f:selectItems value="#{userSpaceView.natures}" var="nature"
								itemLabel="#{nature}" itemValue="#{nature}"
								style="width:100%;height:100%;">

							</f:selectItems>
						</h:selectOneMenu>
						<p:message id="categorieMsg" for="cat" />
						
						
						<p:outputLabel value="Annee:*" />
						<p:inputText value="#{userSpaceView.nouvelleActivite.annee}"
							id="annee" required="true" style="width:100%" label="annee"
							placeholder="YYYY">
							<p:ajax event="keyup" update="anneeMsg"></p:ajax>

						</p:inputText>

						<p:message autoUpdate="true" id="anneeMsg" for="annee" />

						<p:outputLabel value="Description:" />
						<p:inputTextarea rows="3" id="description" minQueryLength="10"
							value="#{userSpaceView.nouvelleActivite.description}"
							style="width:100%" label="description"
							placeholder="Description de l'activite" />
						<p:message id="descMsg" for="description" />

						<p:outputLabel value="Site Web:" />
						<p:inputText value="#{userSpaceView.nouvelleActivite.siteWeb}"
							style="width:100%" label="siteweb" id="siteweb"
							placeholder="https://www.site.fr">
							<f:validator validatorId="website-validator"></f:validator>
						</p:inputText>
						<p:message id="sitewebMsg" for="siteweb" />
						
				



						<p:outputLabel value="" />
						<p:commandButton action="#{userSpaceView.ajouterActivite}" value="Ajouter Activite"
							update="inscription :form" />
						<p:outputLabel value="" />
					</h:panelGrid>

				</p:panel>
			</h:form>

		</f:view>
	</ui:define>
</ui:composition>

</html>